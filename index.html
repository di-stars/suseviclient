<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>suseviclient by ytsarev</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/respond.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!--[if lt IE 8]>
    <link rel="stylesheet" href="stylesheets/ie.css">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <div id="header">
        <nav>
          <li class="fork"><a href="https://github.com/ytsarev/suseviclient">Fork On GitHub</a></li>
          <li class="downloads"><a href="https://github.com/ytsarev/suseviclient/zipball/master">ZIP</a></li>
          <li class="downloads"><a href="https://github.com/ytsarev/suseviclient/tarball/master">TAR</a></li>
          <li class="title">DOWNLOADS</li>
        </nav>
      </div><!-- end header -->

    <div class="wrapper">

      <section>
        <div id="title">
          <h1>suseviclient</h1>
          <p>Lightweight VMware ESXi management tool</p>
          <hr>
          <span class="credits left">Project maintained by <a href="https://github.com/ytsarev">ytsarev</a></span>
          <span class="credits right">Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/mattgraham">mattgraham</a></span>
        </div>

        <h2>Features</h2>

<ul>
<li>
<p>VM creation and provisioning from</p>

<ul>
<li>ISO </li>
<li>VMDK</li>
<li>SUSE Studio</li>
<li>PXE </li>
</ul>
</li>
<li><p>Cloning</p></li>
<li><p>Snapshotting</p></li>
<li><p>Virtual network management</p></li>
<li><p>VM control through VNC</p></li>
<li><p>Exporting to VMware Workstation/Player</p></li>
</ul><h2>How does it work?</h2>

<p>It wraps and automates so called ESXi 'Tech Support Mode' which is effectively ssh server and number of special(poor documented) VMware  management commands.</p>

<p>Currently it well tested with ESXi 4.0/4.1. It should also work with ESX, but it was minimally covered by testing.</p>

<p>Recent ESXi 5.0 support is also tested and implemented.</p>

<h2>Examples</h2>

<pre><code>    cat &gt; ~/.suseviclientrc &lt;&lt; EOF
    esx_server="esxi.example.com"
    studioserver="susestudio.com"
    apiuser="your_user"
    apikey="your_key"
    EOF
</code></pre>

<p>1) Create VM of 512MB RAM and 8GB disk with ISO attached, poweron, connect to VM console:</p>

<pre><code>    suseviclient.sh -c -n "ISO Example" -m 512 -d 8G --iso datastore1/path/to/image.iso
    Enter new VNC password:
    Repeat VNC password:
</code></pre>

<ul>
<li>
<p>List existing VMs</p>

<pre><code>suseviclient.sh -l

Powerstate      VMID    VM Label                                Config file
----------      ----    --------                                -----------
Powered on       16     SLES4VMware 32bit      [datastore1] SLES4VMware 32bit/SLES4VMware 32bit.vmx
Powered on       32     SLES4VMware 64bit      [datastore1] SLES4VMware 64bit/SLES4VMware 64bit.vmx
Powered off      64     ISO Example            [datastore1] ISO Example/ISO Example.vmx
</code></pre>
</li>
<li>
<p>Power on VM</p>

<pre><code>suseviclient.sh --poweron 64
</code></pre>
</li>
</ul><p>Where 64 is VM id.</p>

<ul>
<li>
<p>Connect to VM console</p>

<pre><code>suseviclient.sh --vnc 64
</code></pre>
</li>
</ul><p>2) Create VM from VMDK image( includes automated conversion of desktop vmdk to server version):</p>

<pre><code>    suseviclient.sh -c -n "VMDK Example" --vmdk datastore1/path/to/image.vmdk
</code></pre>

<p>3) Create VM from SUSE Studio appliance</p>

<pre><code>    suseviclient.sh -c -n "Appliance Deployment" --studio $appliance_id
</code></pre>

<p>4) Create VM from PXE </p>

<pre><code>    suseviclient.sh -c -n "PXE Example" -m 512 -d 5G
</code></pre>

<p>This will create blank VM with network attached. If PXE is enabled in your network it should be possible to perform a network boot after the VM is powered on.</p>

<p>For full list of possible options see</p>

<pre><code>    suseviclient.sh --help
</code></pre>

<h2>Installation</h2>

<p>Just download and  put suseviclient.sh somewhere in the $PATH for you convenience.</p>

<p>Shell version of suseviclient introduces no dependencies except of bash, ssh and vncviewer which can be found on almost any Linux desktop.</p>

<p>On the ESXi server side you have to enable ssh access, see: </p>

<p>*<a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1003677">http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1003677</a> for ESXi 4.0
*<a href="http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1017910">http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1017910</a> for ESXi 4.1/5.0</p>

<p>It's recommended to upload your ssh key to the server to not to enter password each time as passing management command through client.
The root fs on ESXi is not permanent storage, so it's recommended to put the key on some connected datastore and automate the key copy on next reboot.</p>

<p>Assuming that you have "datastore1" connected to ESXi server, do this</p>

<pre><code>    mkdir /vmfs/volumes/datastore1/.ssh/ and place your ssh key there

    echo "cp -r /vmfs/volumes/datastore1/.ssh/ /" &gt;&gt; /etc/rc.local
</code></pre>

<p>That's it. It's all you need to start using suseviclient.</p>

<p>All .rb files are additional modules( like web interface) and will be described separately.</p>

<h2>Web Interface</h2>

<p>Web fronted is available with webfrontend.rb currently under initial development state but already fucntional.</p>

<p>It is built with </p>

<ul>
<li>Sinatra ( <a href="http://www.sinatrarb.com/">http://www.sinatrarb.com/</a> ) ruby framework ( so please '#gem install sinatra' if you want to try) </li>
<li>NoVNC ( VNC client using HTML5 WebSockets, Canvas,  <a href="http://kanaka.github.com/noVNC/">http://kanaka.github.com/noVNC/</a> ) to allow access to VMs consoles.</li>
</ul>
      </section>

    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>